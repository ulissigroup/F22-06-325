
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HW4 (due Monday 10/3 noon) [100 pts] &#8212; Numerical Methods and ML for ChE (F22-06-325)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HW5 (due Monday 10/10 noon)" href="HW5.html" />
    <link rel="prev" title="HW3 (due 9/26)" href="HW3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Numerical Methods and ML for ChE (F22-06-325)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction & License
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../notes.html">
   Logistics/Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../schedule.html">
   Course schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../software.html">
   Software Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../helpful_resources.html">
   Helpful Resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../notes/recap.html">
   Recap of Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/review_odes.html">
     ODE Integration (with Events!)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/ode_events_extra_example.html">
     More complicated example: Van der Pol oscillator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/review_optimization.html">
     Local Optimization and Curve Fitting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../notes/intro_ml.html">
   Introduction to Machine Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/ml_basics.html">
     Intro to Supervised Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/overfitting_regularization.html">
     Model Capacity, Overfitting, Regularization, and Ridge/LASSO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/classification_logistic_regression.html">
     Linear models for classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/train_validation.html">
     Validation and Test Splits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/nonparametric.html">
     Non-parametric models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/materials_descriptors.html">
     Featurizing molecules and materials for chemical engineering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/neural_networks.html">
     Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notes/dimensionality_reduction_unsupervised.html">
     Unsupervised learning: dimensionality reduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../labs/overview.html">
   Labs and Python/Software Tips
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../labs/python_debugging.html">
     <font color="red">
      Python functions, Error handling, Exceptions, Debugging
     </font>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../projects/overview.html">
   Course Project Overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/wildfires/wildfire_dataset.html">
     Predicting Wildfire Smoke Composition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/catalysts/catalyst_simulation.html">
     Using ML to Predict Catalyst Properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../projects/travelling_salesman/travelling_salesman.html">
     Finding optimal tours for the Travelling Salesman Problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="homework.html">
   Homeworks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="HW1.html">
     HW1 (due noon Monday 9/5)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HW2.html">
     HW2 (due 9/12)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HW3.html">
     HW3 (due 9/26)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     HW4 (due Monday 10/3 noon) [100 pts]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="HW5.html">
     HW5 (due Monday 10/10 noon)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hw_solutions.html">
     Homework solutions
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ulissigroup/F22-06-325/main?urlpath=lab/tree/f22-06-325/homeworks/HW4.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://laikapack-head.cheme.cmu.edu/hub/hub/user-redirect/git-pull?repo=https%3A//github.com/ulissigroup/F22-06-325&urlpath=lab/tree/F22-06-325/f22-06-325/homeworks/HW4.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ulissigroup/F22-06-325/blob/main/f22-06-325/homeworks/HW4.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ulissigroup/F22-06-325"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ulissigroup/F22-06-325/issues/new?title=Issue%20on%20page%20%2Fhomeworks/HW4.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/homeworks/HW4.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dow-chemical-process-50-pt">
   Dow chemical process [50 pt]
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-validation-test-split">
     Train/validation/test split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-features-with-lasso">
     Polynomial features with LASSO
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree">
     Decision Tree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree-w-polynomial-features">
     Decision Tree w/ Polynomial features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree-analysis">
     Decision Tree Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pick-your-best-model-from-above-and-evaluate-your-final-impurity-error-on-the-test-set">
     Pick your best model from above and evaluate your final impurity error on the test set.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-10pt">
     Bonus [10pt]
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#materials-dataset-practice-50-pt">
   Materials dataset practice [50 pt]
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-dataset-and-train-val-test-split">
     Load the dataset and train/val/test split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-composition-features">
     Generate composition features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-logistic-regression-model-to-the-features">
     Fit a logistic regression model to the features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-decision-tree-classifier">
     Fit a decision tree classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-explainability">
     Model explainability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-error">
     Test error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#materials-prediction">
     Materials prediction
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>HW4 (due Monday 10/3 noon) [100 pts]</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dow-chemical-process-50-pt">
   Dow chemical process [50 pt]
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#train-validation-test-split">
     Train/validation/test split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-features-with-lasso">
     Polynomial features with LASSO
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree">
     Decision Tree
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree-w-polynomial-features">
     Decision Tree w/ Polynomial features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-tree-analysis">
     Decision Tree Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pick-your-best-model-from-above-and-evaluate-your-final-impurity-error-on-the-test-set">
     Pick your best model from above and evaluate your final impurity error on the test set.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bonus-10pt">
     Bonus [10pt]
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#materials-dataset-practice-50-pt">
   Materials dataset practice [50 pt]
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-dataset-and-train-val-test-split">
     Load the dataset and train/val/test split
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-composition-features">
     Generate composition features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-logistic-regression-model-to-the-features">
     Fit a logistic regression model to the features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-decision-tree-classifier">
     Fit a decision tree classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-explainability">
     Model explainability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-error">
     Test error
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#materials-prediction">
     Materials prediction
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <aside class="margin sidebar">
<p class="sidebar-title">Adaptation!</p>
<p>Some of this homework was inspired by or uses content from Prof. AJ Medford (GTech)’s lectures for ChBE4745: https://github.com/medford-group/data_analytics_ChE</p>
<p>The dataset came from Dow Chemicals and released publicly as part of Prof. Medford’s class.</p>
</aside>
<section class="tex2jax_ignore mathjax_ignore" id="hw4-due-monday-10-3-noon-100-pts">
<h1>HW4 (due Monday 10/3 noon) [100 pts]<a class="headerlink" href="#hw4-due-monday-10-3-noon-100-pts" title="Permalink to this headline">#</a></h1>
<section id="dow-chemical-process-50-pt">
<h2>Dow chemical process [50 pt]<a class="headerlink" href="#dow-chemical-process-50-pt" title="Permalink to this headline">#</a></h2>
<p><img alt="DOW process" src="../_images/dow_process.png" /></p>
<p>The dataset contains a number of operating conditions for each of the units in the process, as well as the concentration of impurities in the output stream. Let’s take a look:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;impurity_dataset-training.xlsx&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>x1:Primary Column Reflux Flow</th>
      <th>x2:Primary Column Tails Flow</th>
      <th>x3:Input to Primary Column Bed 3 Flow</th>
      <th>x4:Input to Primary Column Bed 2 Flow</th>
      <th>x5:Primary Column Feed Flow from Feed Column</th>
      <th>x6:Primary Column Make Flow</th>
      <th>x7:Primary Column Base Level</th>
      <th>x8:Primary Column Reflux Drum Pressure</th>
      <th>x9:Primary Column Condenser Reflux Drum Level</th>
      <th>...</th>
      <th>x36: Feed Column Recycle Flow</th>
      <th>x37: Feed Column Tails Flow to Primary Column</th>
      <th>x38: Feed Column Calculated DP</th>
      <th>x39: Feed Column Steam Flow</th>
      <th>x40: Feed Column Tails Flow</th>
      <th>Avg_Reactor_Outlet_Impurity</th>
      <th>Avg_Delta_Composition Primary Column</th>
      <th>y:Impurity</th>
      <th>Primary Column Reflux/Feed Ratio</th>
      <th>Primary Column Make/Reflux Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-12-01 00:00:00</td>
      <td>327.813</td>
      <td>45.7920</td>
      <td>2095.06</td>
      <td>2156.01</td>
      <td>98.5005</td>
      <td>95.4674</td>
      <td>54.3476</td>
      <td>41.0121</td>
      <td>52.2353</td>
      <td>...</td>
      <td>62.8707</td>
      <td>45.0085</td>
      <td>66.6604</td>
      <td>8.68813</td>
      <td>99.9614</td>
      <td>5.38024</td>
      <td>1.49709</td>
      <td>1.77833</td>
      <td>3.32803</td>
      <td>0.291226</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-12-01 01:00:00</td>
      <td>322.970</td>
      <td>46.1643</td>
      <td>2101.00</td>
      <td>2182.90</td>
      <td>98.0014</td>
      <td>94.9673</td>
      <td>54.2247</td>
      <td>41.0076</td>
      <td>52.5378</td>
      <td>...</td>
      <td>62.8651</td>
      <td>45.0085</td>
      <td>66.5496</td>
      <td>8.70683</td>
      <td>99.8637</td>
      <td>5.33345</td>
      <td>1.51392</td>
      <td>1.76964</td>
      <td>3.29556</td>
      <td>0.294044</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-12-01 02:00:00</td>
      <td>319.674</td>
      <td>45.9927</td>
      <td>2102.96</td>
      <td>2151.39</td>
      <td>98.8229</td>
      <td>96.0785</td>
      <td>54.6130</td>
      <td>41.0451</td>
      <td>52.0159</td>
      <td>...</td>
      <td>62.8656</td>
      <td>45.0085</td>
      <td>66.0599</td>
      <td>8.69269</td>
      <td>100.2490</td>
      <td>5.37677</td>
      <td>1.50634</td>
      <td>1.76095</td>
      <td>3.23481</td>
      <td>0.300552</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-12-01 03:00:00</td>
      <td>327.223</td>
      <td>46.0960</td>
      <td>2101.37</td>
      <td>2172.14</td>
      <td>98.7733</td>
      <td>96.1223</td>
      <td>54.9153</td>
      <td>41.0405</td>
      <td>52.9477</td>
      <td>...</td>
      <td>62.8669</td>
      <td>45.0085</td>
      <td>67.9697</td>
      <td>8.70482</td>
      <td>100.3200</td>
      <td>5.32315</td>
      <td>1.47935</td>
      <td>1.75226</td>
      <td>3.31287</td>
      <td>0.293752</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-12-01 04:00:00</td>
      <td>331.177</td>
      <td>45.8493</td>
      <td>2114.06</td>
      <td>2157.77</td>
      <td>99.3231</td>
      <td>94.7521</td>
      <td>54.0925</td>
      <td>40.9934</td>
      <td>53.0507</td>
      <td>...</td>
      <td>62.8673</td>
      <td>45.0085</td>
      <td>67.6454</td>
      <td>8.70077</td>
      <td>100.6590</td>
      <td>5.28227</td>
      <td>1.44489</td>
      <td>1.74357</td>
      <td>3.33435</td>
      <td>0.286107</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div></div></div>
</div>
<p>To use this data, we need to remove some problematic rows. We also want to select all the columns with “x” as features, and select the impurity as “y”. This will leave 10297 data points with 40 features, with the goal being to predict the impurity in the output stream! You should use this code to generate the features (X) and target (y).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_real_and_finite</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">all_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">values</span> <span class="c1">#drop the first column (date)</span>
<span class="n">numeric_map</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">is_real_and_finite</span><span class="p">)</span>
<span class="n">real_rows</span> <span class="o">=</span> <span class="n">numeric_map</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="c1">#True if all values in a row are real numbers</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="n">real_rows</span><span class="p">,:</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="c1">#drop the last 5 cols that are not inputs</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="n">real_rows</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="train-validation-test-split">
<h3>Train/validation/test split<a class="headerlink" href="#train-validation-test-split" title="Permalink to this headline">#</a></h3>
<p>Split the dataset into an 80/10/10 train/val/test split.</p>
</section>
<section id="polynomial-features-with-lasso">
<h3>Polynomial features with LASSO<a class="headerlink" href="#polynomial-features-with-lasso" title="Permalink to this headline">#</a></h3>
<p>Using polynomials up to second order, fit a LASSO model. Print the validation MAE and make a parity plot for your model compared to the experiments!</p>
</section>
<section id="decision-tree">
<h3>Decision Tree<a class="headerlink" href="#decision-tree" title="Permalink to this headline">#</a></h3>
<p>Fit a decision tree to the dataset using just the features. Print the validation MAE and make a parity plot for your model compared to the experiments!</p>
</section>
<section id="decision-tree-w-polynomial-features">
<h3>Decision Tree w/ Polynomial features<a class="headerlink" href="#decision-tree-w-polynomial-features" title="Permalink to this headline">#</a></h3>
<p>Repeat the above using second order polynomial features. Print the validation MAE and make a parity plot for your model. Is this better or worse than just the original decision tree?</p>
</section>
<section id="decision-tree-analysis">
<h3>Decision Tree Analysis<a class="headerlink" href="#decision-tree-analysis" title="Permalink to this headline">#</a></h3>
<p>For your best decision tree above, analyze the first few splits in the tree (either by making a tree plot like we did in class, or with the text analysis. You can also use the feature_importances_ attribute on the fitted model.</p>
<p>Which columns/features are most important for predicting the output impurity?</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The examples for the classification problem here (export_text, plot_tree) also for regression models: https://scikit-learn.org/stable/modules/tree.html</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
<section id="pick-your-best-model-from-above-and-evaluate-your-final-impurity-error-on-the-test-set">
<h3>Pick your best model from above and evaluate your final impurity error on the test set.<a class="headerlink" href="#pick-your-best-model-from-above-and-evaluate-your-final-impurity-error-on-the-test-set" title="Permalink to this headline">#</a></h3>
</section>
<section id="bonus-10pt">
<h3>Bonus [10pt]<a class="headerlink" href="#bonus-10pt" title="Permalink to this headline">#</a></h3>
<p>Try some other models from sklearn to see if you can do better than the decision tree. You can also try using feature selection (like in <a class="reference external" href="https://github.com/medford-group/data_analytics_ChE/blob/master/2-regression/Topic4-High-dimensional_Regression.ipynb">Prof. Medford’s lecture</a>). Remember, when you try different models you can only use the train/validation sets.</p>
<p>If you find a model with a better validation score than your best model above, report the test set accuracy.</p>
</section>
</section>
<section id="materials-dataset-practice-50-pt">
<h2>Materials dataset practice [50 pt]<a class="headerlink" href="#materials-dataset-practice-50-pt" title="Permalink to this headline">#</a></h2>
<p>We saw in class how we could use matminer to generate composition features. In class we built some simple models to predict the band gap of a materials.</p>
<p>I want your help classifying whether a particular material/composition is a metal based on experimental data!</p>
<section id="load-the-dataset-and-train-val-test-split">
<h3>Load the dataset and train/val/test split<a class="headerlink" href="#load-the-dataset-and-train-val-test-split" title="Permalink to this headline">#</a></h3>
<p>Load the “matbench_expt_is_metal” and generate 60/20/20 train/val/test splits.</p>
<p>What fraction of the data is a metal?</p>
</section>
<section id="generate-composition-features">
<h3>Generate composition features<a class="headerlink" href="#generate-composition-features" title="Permalink to this headline">#</a></h3>
<p>Use the magpie features like we did in class.</p>
</section>
<section id="fit-a-logistic-regression-model-to-the-features">
<h3>Fit a logistic regression model to the features<a class="headerlink" href="#fit-a-logistic-regression-model-to-the-features" title="Permalink to this headline">#</a></h3>
<p>Report the accuracy on the validation set. How does this compare to the fraction of metals in the training dataset?</p>
</section>
<section id="fit-a-decision-tree-classifier">
<h3>Fit a decision tree classifier<a class="headerlink" href="#fit-a-decision-tree-classifier" title="Permalink to this headline">#</a></h3>
<p>A decision tree classifier is very similar to the decision tree regressor we used in class. Fit one to your data, and report the accuracy on the validation set. Try playing with the decision tree classifier parameters (like max_depth, etc) to see if you can get better results.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html</p>
</div>
</section>
<section id="model-explainability">
<h3>Model explainability<a class="headerlink" href="#model-explainability" title="Permalink to this headline">#</a></h3>
<p>Look at the feature_importances_ attribute of your fitted decision tree classifier. Which features matter the most in your model? Does this make sense based on what you remember from general chemistry?</p>
</section>
<section id="test-error">
<h3>Test error<a class="headerlink" href="#test-error" title="Permalink to this headline">#</a></h3>
<p>Pick your best model from above and evaluate the test accuracy.</p>
</section>
<section id="materials-prediction">
<h3>Materials prediction<a class="headerlink" href="#materials-prediction" title="Permalink to this headline">#</a></h3>
<p>Go to the Material Project website, then the Materials Explorer app. Filter by “Is Metal” under the electronic structure toggle in the filters list.</p>
<p>Pick three compositions that according to simulations were metals, and 3 that were predicted to be not metals. How does your best classifier from above work on these?</p>
<p>A few things to keep in mind:</p>
<ul class="simple">
<li><p>Simulations are not perfect at predicting experimental properties</p></li>
<li><p>The experimental dataset you used is probably not indicative of all possible structures in the Materials Project</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./homeworks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="HW3.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">HW3 (due 9/26)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="HW5.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">HW5 (due Monday 10/10 noon)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Zachary Ulissi<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>